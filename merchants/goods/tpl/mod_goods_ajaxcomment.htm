<!--[HEAD_CSS]-->
<style>
    .view-hidden{
        border: 1px solid red;
        width: 20%;
        height: 50px;
        padding: 30px;
    }
    .rplay-hidden{
        display: none;
        border:1px solid red;
        width: 30%;
        height:150px;
        text-align: center;
        overflow: hidden;
        /*position: absolute;*/
        }
    .rplay-hidden-view{
        display: none;
        border:1px solid red;
        width: 30%;
        text-align: center;
        overflow: hidden;
    }
    .rplay-hidden span{
        margin-left: -82px;
    }
    .rlay-show{
        display: block;
    }
    .div-button,.div-button-view{
        width: 50px;
        height: 20px;
        background-color: blue;
        border-radius: 5px;
        text-align: center;
        line-height: 20px;
        color: white;
        float: right;
        margin-right: 20px;
    }
    #common{
        position: relative;
    }
</style>
<!--[/HEAD_CSS]-->
<table cellspacing="0" cellpadding="0" class="search_result_tab" id="common">
    <tr>
        <th>评价商品</th>
        <th>评价内容</th>
        <th>商品评分</th>
        <th>评价人</th>
        <th>日期</th>
        <th>状态</th>
        <th>操作</th>
    </tr>
    <!--{foreach from=$commentList item=val}-->
        <tr>
            <td>
                <div class="goods_img" style="float:left;"><img src="<!--{$val.goods_thumb}-->"></div>
                <div class="goods_name"><!--{$val.goods_name}--></div>
            </td>
            <td><div class="manage_goods_name"><!--{$val.content}--></div></td>
            <td><!--{$val.comment_rank}--></td>
            <td><!--{$val.user_name}--></td>
            <td><!--{$val.add_time|date_format:"%Y-%m-%d %H:%M:%S"}--></td>
            <!--{if !empty($val.comment_reply)}-->
            <td>已回复</td>
            <td style="color: red" onclick="viewCommon( <!--{$val.comment_id}-->)">查看回复</td>
            <div class="rplay-hidden-view" id="common<!--{$val.comment_id}-->">
                <span>评论内容： </span><textarea  name="rplay" id="view-rplay<!--{$val.comment_id}-->" cols="30" rows="3" readonly>
                                        </textarea>

                <span>回复内容： </span><textarea name="rplay" id="mechart-rplay<!--{$val.comment_id}-->" cols="30" rows="3" readonly>
                                        </textarea>
                <div class="div-button-view" id="button-view">确定</div>
            </div>
                <!--{else}-->
            <td>未回复</td>
            <td style="color: red" onclick="relayCommon( <!--{$val.comment_id}-->)">回复</td>
            <div class="rplay-hidden" id="rplay-common<!--{$val.comment_id}-->">
                <span>请输入回复类容： </span><textarea name="rplay" id="content" cols="30" rows="3">
                    </textarea>
                <input type="hidden" value="<!--{$val.comment_id}-->" id="comment_id"/>
                <div class="div-button">确定</div>
            </div>
                <!--{/if}-->
        </tr>
    <!--{/foreach}-->
</table>
    <div id="kkpager<!--{$current}-->" class="kkpager" style="float:right;clear:none;padding:0px;"></div>
<script>
        var curpage=<!--{$page.curpage}-->
        var maxpage =<!--{$page.maxpage}-->
        var totalnum =<!--{$page.totalnum}-->
        var currentType =<!--{$current}-->
    $(function(){
        generatePage(curpage, maxpage, totalnum ,currentType);
    })
    function generatePage(pageNo, totalPage, totalRecords,currentType) {
        //生成分页
       kkpager.pagerid ="kkpager"+currentType;
        kkpager.generPageHtml({
            pno: pageNo,
            //总页码
            total: totalPage,
            //总数据条数
            totalRecords: totalRecords,
            isGoPage: false,
            mode: 'click',
            click: function (n) {
                this.selectPage(n);
                loadTableContent(n, false,current);
            }
        }, true);
    };
    function viewCommon(comment_id){
        var id= "#common"+comment_id
        $(id).removeClass("hidden").addClass("rlay-show");
        var url ="/goods/viewrplay";
        var data={"common_id":comment_id};
        F.postWithLoading(url,data,function(ret){
            if(ret.status==1){
                     var commonList=ret.common
                $("#view-rplay"+comment_id).val(commonList.content)
                $("#mechart-rplay"+comment_id).val(commonList.comment_reply)
            }
        })
    }

    function relayCommon(comment_id){
        var id= "#rplay-common"+comment_id
        $(id).removeClass("hidden").addClass("rlay-show");

    }
        function getMousePos(event) {
            var e = event || window.event;
            return [e.screenX,e.screenY]
        }
    $(".div-button").click(function(){
        var url ="/goods/rplayCommone";
        var common_id=$("#comment_id").val()
        var content=$("#content").val()
        var data ={"common_id":common_id,"content":content}
        F.postWithLoading(url,data,function(ret){
            if(ret.status==1){
                showMsg(ret.retmsg);
            }
        })
    })
        $("#button-view").click(function(){
            $(this).parents().removeClass("rlay-show");
        })
</script>